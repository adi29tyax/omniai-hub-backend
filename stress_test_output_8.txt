============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0
rootdir: E:\omniai-studio-universe\hub-backend
plugins: anyio-4.11.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 1 item

app\tests\load\test_autodirector_load.py F                               [100%]

================================== FAILURES ===================================
___________________________ test_autodirector_load ____________________________

    @pytest.mark.asyncio
    async def test_autodirector_load():
        print("\n--- STARTING AUTO-DIRECTOR LOAD TEST (10 Concurrent) ---")
    
        # Patch all external services to avoid rate limits/costs
        with patch("app.modules.director.auto_director_service.call_gemini", new_callable=AsyncMock) as mock_gemini_auto, \
             patch("app.modules.director.breakdown_service.call_gemini", new_callable=AsyncMock) as mock_gemini_breakdown, \
             patch("app.modules.director.keyframe_service.call_gemini", new_callable=AsyncMock) as mock_gemini_keyframe, \
             patch("app.modules.director.animation_service.call_gemini", new_callable=AsyncMock) as mock_gemini_anim, \
             patch("app.modules.director.audio_service.call_gemini", new_callable=AsyncMock) as mock_gemini_audio, \
             patch("app.modules.director.sound_designer.call_gemini", new_callable=AsyncMock) as mock_gemini_sfx, \
             patch("app.modules.director.music_generator.call_gemini", new_callable=AsyncMock) as mock_gemini_bgm, \
             patch("app.storage.r2.upload_stream_to_r2") as mock_upload_stream, \
             patch("app.modules.director.timeline_service.upload_public") as mock_upload_public, \
             patch("app.modules.director.ffmpeg_worker.compile_timeline", new_callable=AsyncMock) as mock_ffmpeg, \
             patch("app.modules.director.model_workers.call_sfx_gen", new_callable=AsyncMock) as mock_sfx_gen, \
             patch("app.modules.director.model_workers.call_music_gen", new_callable=AsyncMock) as mock_music_gen:
    
            # Configure Mocks to return valid JSON always
            mock_gemini_auto.return_value = MOCK_STORY_JSON
            mock_gemini_breakdown.return_value = MOCK_BREAKDOWN_JSON
            mock_gemini_keyframe.return_value = MOCK_KEYFRAME_JSON
            mock_gemini_anim.return_value = MOCK_KEYFRAME_JSON
            mock_gemini_audio.return_value = MOCK_AUDIO_JSON
            mock_gemini_sfx.return_value = MOCK_SFX_JSON
            mock_gemini_bgm.return_value = MOCK_BGM_JSON
    
            mock_upload_stream.return_value = {"url": "http://mock/file", "key": "key"}
            mock_upload_public.return_value = {"url": "http://mock/video.mp4", "key": "video.mp4"}
            mock_ffmpeg.return_value = {"status": "success", "output_path": "out.mp4"}
            mock_sfx_gen.return_value = "http://mock/sfx.wav"
            mock_music_gen.return_value = "http://mock/bgm.wav"
    
            # Run 10 concurrent requests
            from httpx import AsyncClient, ASGITransport
    
            async with AsyncClient(transport=ASGITransport(app=app), base_url="http://test") as ac:
                tasks = []
                for i in range(10):
                    tasks.append(ac.post("/director/auto/generate-episode", json={
                        "project_id": f"123e4567-e89b-12d3-a456-42661417400{i}", # Valid UUIDs
                        "concept": f"Load Test {i}",
                        "style": "Anime",
                        "duration": 1
                    }))
    
                results = await asyncio.gather(*tasks)
    
                success_count = 0
                for res in results:
                    if res.status_code == 200:
                        success_count += 1
                    else:
                        print(f"Failed: {res.text}")
    
                print(f"Success: {success_count}/10")
>               assert success_count == 10
E               assert 0 == 10

app\tests\load\test_autodirector_load.py:94: AssertionError
---------------------------- Captured stdout call -----------------------------

--- STARTING AUTO-DIRECTOR LOAD TEST (10 Concurrent) ---
2025-11-30 14:17:29,757 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174000
2025-11-30 14:17:29,757 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 0'
2025-11-30 14:17:30,119 - omnistudio - INFO - Breaking down scene 01a30c55-1e89-4496-8354-39c08d67a1c4 for story 265de1f8-7ab3-4eca-b2b2-4b3d230c5cb3
2025-11-30 14:17:30,201 - omnistudio - INFO - Generating keyframe for shot 61f90c1c-cfe2-4b7c-ad35-091b7ca28f1a
2025-11-30 14:17:30,288 - omnistudio - INFO - Generating animation for shot 61f90c1c-cfe2-4b7c-ad35-091b7ca28f1a with model Luma-Dream-Machine
2025-11-30 14:17:30,370 - omnistudio - INFO - Generating SFX for shot 61f90c1c-cfe2-4b7c-ad35-091b7ca28f1a
2025-11-30 14:17:30,449 - omnistudio - INFO - Generating BGM for scene 01a30c55-1e89-4496-8354-39c08d67a1c4
2025-11-30 14:17:30,540 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174000
2025-11-30 14:17:30,542 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174001
2025-11-30 14:17:30,543 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 1'
2025-11-30 14:17:30,723 - omnistudio - INFO - Breaking down scene 966e73ed-da35-4464-be4c-3057319dc206 for story 96f9b10d-661c-4bf9-96c6-b8656491f3a8
2025-11-30 14:17:30,807 - omnistudio - INFO - Generating keyframe for shot 168aa076-5f3f-4d3a-b021-9b4f6c2e93b6
2025-11-30 14:17:30,892 - omnistudio - INFO - Generating animation for shot 168aa076-5f3f-4d3a-b021-9b4f6c2e93b6 with model Luma-Dream-Machine
2025-11-30 14:17:30,978 - omnistudio - INFO - Generating SFX for shot 168aa076-5f3f-4d3a-b021-9b4f6c2e93b6
2025-11-30 14:17:31,060 - omnistudio - INFO - Generating BGM for scene 966e73ed-da35-4464-be4c-3057319dc206
2025-11-30 14:17:31,146 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174001
2025-11-30 14:17:31,148 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174002
2025-11-30 14:17:31,148 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 2'
2025-11-30 14:17:31,317 - omnistudio - INFO - Breaking down scene f7c5b348-5adc-4dbd-a425-b5f2f5352150 for story 18dd94e8-640a-4e46-b375-3a46b4bf8ea2
2025-11-30 14:17:31,400 - omnistudio - INFO - Generating keyframe for shot 19d164db-8ce9-480c-be70-c1c01e8e7a82
2025-11-30 14:17:31,487 - omnistudio - INFO - Generating animation for shot 19d164db-8ce9-480c-be70-c1c01e8e7a82 with model Luma-Dream-Machine
2025-11-30 14:17:31,567 - omnistudio - INFO - Generating SFX for shot 19d164db-8ce9-480c-be70-c1c01e8e7a82
2025-11-30 14:17:31,655 - omnistudio - INFO - Generating BGM for scene f7c5b348-5adc-4dbd-a425-b5f2f5352150
2025-11-30 14:17:31,741 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174002
2025-11-30 14:17:31,744 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174003
2025-11-30 14:17:31,744 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 3'
2025-11-30 14:17:31,912 - omnistudio - INFO - Breaking down scene 66d66fa9-f913-42cf-977c-0bd6416827b9 for story f0a2541e-dafc-4a5e-b0fe-8a3c9d8f41cc
2025-11-30 14:17:31,996 - omnistudio - INFO - Generating keyframe for shot 8473c303-62f6-402b-9a8c-f18e0d8bacc8
2025-11-30 14:17:32,094 - omnistudio - INFO - Generating animation for shot 8473c303-62f6-402b-9a8c-f18e0d8bacc8 with model Luma-Dream-Machine
2025-11-30 14:17:32,179 - omnistudio - INFO - Generating SFX for shot 8473c303-62f6-402b-9a8c-f18e0d8bacc8
2025-11-30 14:17:32,261 - omnistudio - INFO - Generating BGM for scene 66d66fa9-f913-42cf-977c-0bd6416827b9
2025-11-30 14:17:32,347 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174003
2025-11-30 14:17:32,350 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174004
2025-11-30 14:17:32,350 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 4'
2025-11-30 14:17:32,545 - omnistudio - INFO - Breaking down scene 312b182a-b26e-4a78-b50e-36aa2f053c89 for story 7a95c7a4-a5ca-48dc-adb1-eeafc61c89b6
2025-11-30 14:17:32,624 - omnistudio - INFO - Generating keyframe for shot 0b3b2413-afda-4d8d-8584-f62310f71085
2025-11-30 14:17:32,710 - omnistudio - INFO - Generating animation for shot 0b3b2413-afda-4d8d-8584-f62310f71085 with model Luma-Dream-Machine
2025-11-30 14:17:32,796 - omnistudio - INFO - Generating SFX for shot 0b3b2413-afda-4d8d-8584-f62310f71085
2025-11-30 14:17:32,890 - omnistudio - INFO - Generating BGM for scene 312b182a-b26e-4a78-b50e-36aa2f053c89
2025-11-30 14:17:32,975 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174004
2025-11-30 14:17:32,977 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174005
2025-11-30 14:17:32,977 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 5'
2025-11-30 14:17:33,145 - omnistudio - INFO - Breaking down scene 40aa4477-e6f6-4e7e-b9e9-0505206a7ad2 for story 2088e9e4-b432-49d1-9ba1-2607507aa17e
2025-11-30 14:17:33,230 - omnistudio - INFO - Generating keyframe for shot 632ffee9-6a9a-44f0-bf32-53f3f7faae21
2025-11-30 14:17:33,316 - omnistudio - INFO - Generating animation for shot 632ffee9-6a9a-44f0-bf32-53f3f7faae21 with model Luma-Dream-Machine
2025-11-30 14:17:33,399 - omnistudio - INFO - Generating SFX for shot 632ffee9-6a9a-44f0-bf32-53f3f7faae21
2025-11-30 14:17:33,485 - omnistudio - INFO - Generating BGM for scene 40aa4477-e6f6-4e7e-b9e9-0505206a7ad2
2025-11-30 14:17:33,570 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174005
2025-11-30 14:17:33,571 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174006
2025-11-30 14:17:33,571 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 6'
2025-11-30 14:17:33,744 - omnistudio - INFO - Breaking down scene 6468ccd6-8acc-4e0f-bcf9-4a7838b150cf for story 9a73aa75-0dd1-46ea-be8d-2393e4c1801c
2025-11-30 14:17:33,827 - omnistudio - INFO - Generating keyframe for shot db6ad46b-75c7-43aa-addf-89240df5aea7
2025-11-30 14:17:33,911 - omnistudio - INFO - Generating animation for shot db6ad46b-75c7-43aa-addf-89240df5aea7 with model Luma-Dream-Machine
2025-11-30 14:17:33,996 - omnistudio - INFO - Generating SFX for shot db6ad46b-75c7-43aa-addf-89240df5aea7
2025-11-30 14:17:34,080 - omnistudio - INFO - Generating BGM for scene 6468ccd6-8acc-4e0f-bcf9-4a7838b150cf
2025-11-30 14:17:34,166 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174006
2025-11-30 14:17:34,167 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174007
2025-11-30 14:17:34,167 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 7'
2025-11-30 14:17:34,335 - omnistudio - INFO - Breaking down scene bd6c7ac7-95fd-4cca-851e-591bc720b4a1 for story c9c53d70-d1d4-441e-96f9-450340f2cf2a
2025-11-30 14:17:34,420 - omnistudio - INFO - Generating keyframe for shot 514b1da0-1649-466b-b0df-9da42430efbe
2025-11-30 14:17:34,506 - omnistudio - INFO - Generating animation for shot 514b1da0-1649-466b-b0df-9da42430efbe with model Luma-Dream-Machine
2025-11-30 14:17:34,590 - omnistudio - INFO - Generating SFX for shot 514b1da0-1649-466b-b0df-9da42430efbe
2025-11-30 14:17:34,675 - omnistudio - INFO - Generating BGM for scene bd6c7ac7-95fd-4cca-851e-591bc720b4a1
2025-11-30 14:17:34,761 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174007
2025-11-30 14:17:34,762 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174008
2025-11-30 14:17:34,763 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 8'
2025-11-30 14:17:34,929 - omnistudio - INFO - Breaking down scene ddc780a9-cf9c-4b34-b727-4f1a0ef6a305 for story 45262257-0740-45c6-9ecf-a1b62809e2bc
2025-11-30 14:17:35,060 - omnistudio - INFO - Generating keyframe for shot 68f6f76d-db2c-47cd-b175-76086c8b56ca
2025-11-30 14:17:35,181 - omnistudio - INFO - Generating animation for shot 68f6f76d-db2c-47cd-b175-76086c8b56ca with model Luma-Dream-Machine
2025-11-30 14:17:35,265 - omnistudio - INFO - Generating SFX for shot 68f6f76d-db2c-47cd-b175-76086c8b56ca
2025-11-30 14:17:35,349 - omnistudio - INFO - Generating BGM for scene ddc780a9-cf9c-4b34-b727-4f1a0ef6a305
2025-11-30 14:17:35,440 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174008
2025-11-30 14:17:35,443 - omnistudio - INFO - Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174009
2025-11-30 14:17:35,443 - omnistudio - INFO - Auto-Director: Generating story for concept 'Load Test 9'
2025-11-30 14:17:35,606 - omnistudio - INFO - Breaking down scene bd469d44-1737-4b88-8729-73257685ab02 for story 955628f1-701a-4d48-a41d-d521e8525f10
2025-11-30 14:17:35,690 - omnistudio - INFO - Generating keyframe for shot 3106c583-e231-4c30-8c65-cf11c35168ad
2025-11-30 14:17:35,777 - omnistudio - INFO - Generating animation for shot 3106c583-e231-4c30-8c65-cf11c35168ad with model Luma-Dream-Machine
2025-11-30 14:17:35,861 - omnistudio - INFO - Generating SFX for shot 3106c583-e231-4c30-8c65-cf11c35168ad
2025-11-30 14:17:35,976 - omnistudio - INFO - Generating BGM for scene bd469d44-1737-4b88-8729-73257685ab02
2025-11-30 14:17:36,108 - omnistudio - INFO - Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174009
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Failed: {"detail":"'temp_dir'"}
Success: 0/10
------------------------------ Captured log call ------------------------------
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174000
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 0'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene 01a30c55-1e89-4496-8354-39c08d67a1c4 for story 265de1f8-7ab3-4eca-b2b2-4b3d230c5cb3
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 61f90c1c-cfe2-4b7c-ad35-091b7ca28f1a
INFO     omnistudio:animation_service.py:17 Generating animation for shot 61f90c1c-cfe2-4b7c-ad35-091b7ca28f1a with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 61f90c1c-cfe2-4b7c-ad35-091b7ca28f1a
INFO     omnistudio:audio_service.py:100 Generating BGM for scene 01a30c55-1e89-4496-8354-39c08d67a1c4
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174000
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174001
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 1'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene 966e73ed-da35-4464-be4c-3057319dc206 for story 96f9b10d-661c-4bf9-96c6-b8656491f3a8
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 168aa076-5f3f-4d3a-b021-9b4f6c2e93b6
INFO     omnistudio:animation_service.py:17 Generating animation for shot 168aa076-5f3f-4d3a-b021-9b4f6c2e93b6 with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 168aa076-5f3f-4d3a-b021-9b4f6c2e93b6
INFO     omnistudio:audio_service.py:100 Generating BGM for scene 966e73ed-da35-4464-be4c-3057319dc206
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174001
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174002
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 2'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene f7c5b348-5adc-4dbd-a425-b5f2f5352150 for story 18dd94e8-640a-4e46-b375-3a46b4bf8ea2
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 19d164db-8ce9-480c-be70-c1c01e8e7a82
INFO     omnistudio:animation_service.py:17 Generating animation for shot 19d164db-8ce9-480c-be70-c1c01e8e7a82 with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 19d164db-8ce9-480c-be70-c1c01e8e7a82
INFO     omnistudio:audio_service.py:100 Generating BGM for scene f7c5b348-5adc-4dbd-a425-b5f2f5352150
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174002
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174003
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 3'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene 66d66fa9-f913-42cf-977c-0bd6416827b9 for story f0a2541e-dafc-4a5e-b0fe-8a3c9d8f41cc
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 8473c303-62f6-402b-9a8c-f18e0d8bacc8
INFO     omnistudio:animation_service.py:17 Generating animation for shot 8473c303-62f6-402b-9a8c-f18e0d8bacc8 with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 8473c303-62f6-402b-9a8c-f18e0d8bacc8
INFO     omnistudio:audio_service.py:100 Generating BGM for scene 66d66fa9-f913-42cf-977c-0bd6416827b9
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174003
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174004
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 4'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene 312b182a-b26e-4a78-b50e-36aa2f053c89 for story 7a95c7a4-a5ca-48dc-adb1-eeafc61c89b6
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 0b3b2413-afda-4d8d-8584-f62310f71085
INFO     omnistudio:animation_service.py:17 Generating animation for shot 0b3b2413-afda-4d8d-8584-f62310f71085 with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 0b3b2413-afda-4d8d-8584-f62310f71085
INFO     omnistudio:audio_service.py:100 Generating BGM for scene 312b182a-b26e-4a78-b50e-36aa2f053c89
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174004
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174005
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 5'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene 40aa4477-e6f6-4e7e-b9e9-0505206a7ad2 for story 2088e9e4-b432-49d1-9ba1-2607507aa17e
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 632ffee9-6a9a-44f0-bf32-53f3f7faae21
INFO     omnistudio:animation_service.py:17 Generating animation for shot 632ffee9-6a9a-44f0-bf32-53f3f7faae21 with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 632ffee9-6a9a-44f0-bf32-53f3f7faae21
INFO     omnistudio:audio_service.py:100 Generating BGM for scene 40aa4477-e6f6-4e7e-b9e9-0505206a7ad2
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174005
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174006
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 6'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene 6468ccd6-8acc-4e0f-bcf9-4a7838b150cf for story 9a73aa75-0dd1-46ea-be8d-2393e4c1801c
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot db6ad46b-75c7-43aa-addf-89240df5aea7
INFO     omnistudio:animation_service.py:17 Generating animation for shot db6ad46b-75c7-43aa-addf-89240df5aea7 with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot db6ad46b-75c7-43aa-addf-89240df5aea7
INFO     omnistudio:audio_service.py:100 Generating BGM for scene 6468ccd6-8acc-4e0f-bcf9-4a7838b150cf
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174006
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174007
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 7'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene bd6c7ac7-95fd-4cca-851e-591bc720b4a1 for story c9c53d70-d1d4-441e-96f9-450340f2cf2a
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 514b1da0-1649-466b-b0df-9da42430efbe
INFO     omnistudio:animation_service.py:17 Generating animation for shot 514b1da0-1649-466b-b0df-9da42430efbe with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 514b1da0-1649-466b-b0df-9da42430efbe
INFO     omnistudio:audio_service.py:100 Generating BGM for scene bd6c7ac7-95fd-4cca-851e-591bc720b4a1
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174007
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174008
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 8'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene ddc780a9-cf9c-4b34-b727-4f1a0ef6a305 for story 45262257-0740-45c6-9ecf-a1b62809e2bc
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 68f6f76d-db2c-47cd-b175-76086c8b56ca
INFO     omnistudio:animation_service.py:17 Generating animation for shot 68f6f76d-db2c-47cd-b175-76086c8b56ca with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 68f6f76d-db2c-47cd-b175-76086c8b56ca
INFO     omnistudio:audio_service.py:100 Generating BGM for scene ddc780a9-cf9c-4b34-b727-4f1a0ef6a305
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174008
INFO     omnistudio:auto_director_service.py:79 Auto-Director: Starting full episode generation for project 123e4567-e89b-12d3-a456-426614174009
INFO     omnistudio:auto_director_service.py:22 Auto-Director: Generating story for concept 'Load Test 9'
INFO     omnistudio:breakdown_service.py:22 Breaking down scene bd469d44-1737-4b88-8729-73257685ab02 for story 955628f1-701a-4d48-a41d-d521e8525f10
INFO     omnistudio:keyframe_service.py:17 Generating keyframe for shot 3106c583-e231-4c30-8c65-cf11c35168ad
INFO     omnistudio:animation_service.py:17 Generating animation for shot 3106c583-e231-4c30-8c65-cf11c35168ad with model Luma-Dream-Machine
INFO     omnistudio:audio_service.py:78 Generating SFX for shot 3106c583-e231-4c30-8c65-cf11c35168ad
INFO     omnistudio:audio_service.py:100 Generating BGM for scene bd469d44-1737-4b88-8729-73257685ab02
INFO     omnistudio:timeline_service.py:9 Compiling episode 'Load Test Story' for project 123e4567-e89b-12d3-a456-426614174009
============================== warnings summary ===============================
app\config.py:3
  E:\omniai-studio-universe\hub-backend\app\config.py:3: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Settings(BaseSettings):

app\modules\director\schemas.py:14
  E:\omniai-studio-universe\hub-backend\app\modules\director\schemas.py:14: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DirectorProjectResponse(DirectorProjectBase):

app\modules\director\schemas.py:33
  E:\omniai-studio-universe\hub-backend\app\modules\director\schemas.py:33: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DirectorStoryResponse(DirectorStoryBase):

app\modules\director\schemas.py:53
  E:\omniai-studio-universe\hub-backend\app\modules\director\schemas.py:53: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class CharacterResponse(CharacterBase):

app\modules\director\schemas.py:71
  E:\omniai-studio-universe\hub-backend\app\modules\director\schemas.py:71: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class SceneResponse(SceneBase):

app\modules\director\schemas.py:89
  E:\omniai-studio-universe\hub-backend\app\modules\director\schemas.py:89: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ShotResponse(ShotBase):

app\modules\director\schemas.py:112
  E:\omniai-studio-universe\hub-backend\app\modules\director\schemas.py:112: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class AssetResponse(AssetBase):

app\modules\projects\schema.py:16
  E:\omniai-studio-universe\hub-backend\app\modules\projects\schema.py:16: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ProjectResponse(BaseModel):

app\modules\project_files\schema.py:17
  E:\omniai-studio-universe\hub-backend\app\modules\project_files\schema.py:17: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class FileResponse(BaseModel):

app\modules\project_files\schema.py:30
  E:\omniai-studio-universe\hub-backend\app\modules\project_files\schema.py:30: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class FileTreeItem(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED app/tests/load/test_autodirector_load.py::test_autodirector_load - ass...
======================= 1 failed, 10 warnings in 8.40s ========================
============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0
rootdir: E:\omniai-studio-universe\hub-backend
plugins: anyio-4.11.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 1 item

app\tests\load\test_ffmpeg_stress.py .                                   [100%]

============================== 1 passed in 0.38s ==============================
============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0
rootdir: E:\omniai-studio-universe\hub-backend
plugins: anyio-4.11.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 1 item

app\tests\load\test_r2_upload_stress.py .                                [100%]

============================== warnings summary ===============================
app\config.py:3
  E:\omniai-studio-universe\hub-backend\app\config.py:3: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Settings(BaseSettings):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================== 1 passed, 1 warning in 0.44s =========================
============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0
rootdir: E:\omniai-studio-universe\hub-backend
plugins: anyio-4.11.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 0 items / 1 error

=================================== ERRORS ====================================
___________ ERROR collecting app/tests/load/test_timeline_batch.py ____________
C:\Users\DELL\AppData\Roaming\Python\Python311\site-packages\_pytest\python.py:507: in importtestmodule
    mod = import_path(
C:\Users\DELL\AppData\Roaming\Python\Python311\site-packages\_pytest\pathlib.py:587: in import_path
    importlib.import_module(module_name)
C:\Program Files\Python311\Lib\importlib\__init__.py:126: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<frozen importlib._bootstrap>:1204: in _gcd_import
    ???
<frozen importlib._bootstrap>:1176: in _find_and_load
    ???
<frozen importlib._bootstrap>:1147: in _find_and_load_unlocked
    ???
<frozen importlib._bootstrap>:690: in _load_unlocked
    ???
C:\Users\DELL\AppData\Roaming\Python\Python311\site-packages\_pytest\assertion\rewrite.py:188: in exec_module
    source_stat, co = _rewrite_test(fn, self.config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\DELL\AppData\Roaming\Python\Python311\site-packages\_pytest\assertion\rewrite.py:357: in _rewrite_test
    tree = ast.parse(source, filename=strfn)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Program Files\Python311\Lib\ast.py:50: in parse
    return compile(source, filename, mode, flags,
E     File "E:\omniai-studio-universe\hub-backend\app\tests\load\test_timeline_batch.py", line 28
E       tasks = [run_timeline_build(i) for i in range(30)]
E                                                         ^
E   IndentationError: unindent does not match any outer indentation level
=========================== short test summary info ===========================
ERROR app/tests/load/test_timeline_batch.py
!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
============================== 1 error in 0.25s ===============================
============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0
rootdir: E:\omniai-studio-universe\hub-backend
plugins: anyio-4.11.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 1 item

app\tests\load\test_ai_worker_stress.py .                                [100%]

============================= 1 passed in 48.37s ==============================
--- STARTING PHASE 9.4 LOAD & STRESS TESTS ---

[1/5] Running Auto-Director Load Test...
Time: 9.90s

[2/5] Running FFmpeg Stress Test...
Time: 1.36s

[3/5] Running R2 Upload Stress Test...
Time: 1.16s

[4/5] Running Timeline Batch Test...
Time: 0.86s

[5/5] Running AI Worker Stress Test...
Time: 49.00s

--- PHASE 9.4 LOAD & STRESS TEST COMPLETE ---

Summary:
{
  "results": {
    "autodirector": "FAIL",
    "ffmpeg": "PASS",
    "r2_upload": "PASS",
    "timeline": "FAIL",
    "ai_worker": "PASS"
  },
  "resources": {
    "cpu_max": 96.1,
    "cpu_avg": 50.16451612903227,
    "memory_max": 84.8,
    "memory_avg": 83.83548387096776,
    "disk_max": 5.5
  }
}
